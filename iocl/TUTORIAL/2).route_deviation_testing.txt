#1>. query to check number of data processed:

 select COUNT(*) from HTP_TEST WHERE CNT=55555;

 #2>. query to check number of data enter in root deviation exception table:
 select COUNT(*) from HTP_TEST WHERE CNT=11111;

 #3>. query to check number of data processed in root deviation table:


 SELECT  IS_CHECKED, IRD_IS_DONE, IRD_VEH_ID, IRD_VEH_ID, IAC_IID_ROUTE_ID, IAC_IID_VEHICLE_NO, IAC_IID_SUPPLY_PLANT_CODE, IRD_TRIP_ID,IAC_IID_INVOICE_DATE, IAC_IID_TRIP_ACTUAL_START_TIME, IAC_IID_TRIP_ACTUAL_END_TIME, IRD_DEV_START_AT, IRD_DEV_END_AT,    IAC_TMP_IDLE_START_TIME, IAC_TMP_IDLE_END_TIME, IAC_TMP_TOTAL_STOPPAGE

FROM    iocl.IOCL_ROUTE_DEVIATIONS_NEW D
        JOIN iocl.IOCL_ALLIDLE_CLOSEDTRIPS I ON D.IRD_TRIP_ID = I.IAC_IID_SUPPLY_PLANT_CODE  

WHERE
          D.IRD_DEV_DUR_IN_MINS >= 5
      AND TIMESTAMPDIFF(SECOND, I.IAC_TMP_IDLE_START_TIME, I.IAC_TMP_IDLE_END_TIME)/60 >= 5
    AND D.IRD_IS_DONE = 0
      AND D.IRD_DEV_END_AT >= DATE_ADD(CURDATE(), INTERVAL -14 DAY)
      AND I.IAC_IID_TRIP_ACTUAL_END_TIME >= DATE_ADD(CURDATE(), INTERVAL -14 DAY)
  
      AND I.IAC_TMP_IDLE_START_TIME >= D.IRD_DEV_START_AT
--      AND I.IAC_TMP_IDLE_START_TIME <= D.IRD_DEV_END_AT
--      AND I.IAC_TMP_IDLE_END_TIME >= D.IRD_DEV_START_AT
      AND I.IAC_TMP_IDLE_END_TIME <= D.IRD_DEV_END_AT;
      
     


      
      
      
#4>.query to check number of  has to processed data processed


SELECT DISTINCT ID.IID_TRIP_ID,
ID.IID_MATERIAL_CODE,
ID.IID_QUANTITY,
ID.IID_FUEL_UNIT,
ID.IID_PARTY_CODE,
ID.IID_PARTY_NAME,
ID.IID_VEHICLE_NO,
ID.IID_INVOICE_DATE,
ID.IID_SUPPLY_PLANT_CODE,
ID.IID_SUPPLY_PLANT,
ID.IID_SALESAREA_CODE,
ID.IID_DELIVERY_TYPE,
ID.IID_TRIP_STATUS,
ID.IID_TRIP_ACTUAL_START_TIME,
ID.IID_TRIP_ACTUAL_END_TIME,
ID.IID_TRIP_FORCE_CLOSED_TIME,
ID.IID_TRIP_DISTANCE,
ID.IID_VEHICLE_ID,
ID.IID_ROUTE_ID,
(CASE WHEN ID.IID_TRIP_ACTUAL_START_TIME IS NULL THEN ID.IID_INVOICE_DATE
      ELSE ID.IID_TRIP_ACTUAL_START_TIME
 END
)FROM_TIME,
(CASE WHEN ID.IID_TRIP_STATUS=2 THEN ID.IID_TRIP_ACTUAL_END_TIME 
      WHEN ID.IID_TRIP_STATUS IN (3,4) THEN ID.IID_TRIP_FORCE_CLOSED_TIME 
END
)TO_TIME,(SELECT (CASE WHEN UPPER(EDM_DEVICE_NO) LIKE 'E%' THEN 'EFK' ELSE 'QCQ' END)  DEV_TYPE FROM ETRK_DEVICE_MST WHERE EDM_DEVICE_ID IN (SELECT EVM_DEVICE_ID FROM ETRK_VEHICLE_MST WHERE EVM_VEHICLE_ID=iid_vehicle_id))

FROM IOCL_INVOICE_DATA ID JOIN IOCL_ROUTE_DEVIATIONS_NEW DN 
 ON ID.IID_SUPPLY_PLANT_CODE = DN.IRD_TRIP_ID WHERE IRD_DEV_DUR_IN_MINS>=5
-- AND ID.IID_TRIP_ID IN (1898633, 1901429, 1901372, 1901024, 1900006, 1900007, 1899191, 1899143, 1899038, 1899039, 1898865, 1898866, 1898756, 1897917, 1897918, 1974170)
 AND ID.IID_SUPPLY_PLANT_CODE IN (SELECT  IRD_TRIP_ID

FROM    iocl.IOCL_ROUTE_DEVIATIONS_NEW D
        JOIN iocl.IOCL_ALLIDLE_CLOSEDTRIPS I ON D.IRD_TRIP_ID = I.IAC_IID_SUPPLY_PLANT_CODE  

WHERE
          D.IRD_DEV_DUR_IN_MINS >= 5
      AND TIMESTAMPDIFF(SECOND, I.IAC_TMP_IDLE_START_TIME, I.IAC_TMP_IDLE_END_TIME)/60 >= 5
    AND D.IRD_IS_DONE = 0
      AND D.IRD_DEV_END_AT >= DATE_ADD(CURDATE(), INTERVAL -15 DAY)
      AND I.IAC_IID_TRIP_ACTUAL_END_TIME >= DATE_ADD(CURDATE(), INTERVAL -15 DAY)
  
      AND I.IAC_TMP_IDLE_START_TIME >= D.IRD_DEV_START_AT
--      AND I.IAC_TMP_IDLE_START_TIME <= D.IRD_DEV_END_AT
--      AND I.IAC_TMP_IDLE_END_TIME >= D.IRD_DEV_START_AT
      AND I.IAC_TMP_IDLE_END_TIME <= D.IRD_DEV_END_AT
      
      
)
AND DN.IRD_IS_DONE =0 AND DN.IRD_DEV_END_AT >= DATE_ADD(CURDATE(), INTERVAL -15 DAY)

AND UPPER(ID.IID_IS_SCHDLR_CALLED)='YES' AND ID.IID_IS_RD_PROCESSED=2 AND ID.IID_VEHICLE_ID is NOT NULL
ORDER BY ID.iid_created_at DESC, IID_SUPPLY_PLANT_CODE;

#5>.

SELECT * FROM IOCL_INVOICE_DATA WHERE IID_SUPPLY_PLANT_CODE IN ('0682248010');

SELECT * FROM IOCL_ALLIDLE_CLOSEDTRIPS WHERE IAC_IID_SUPPLY_PLANT_CODE='0682248010';
SELECT * FROM IOCL_ROUTE_DEVIATIONS_NEW WHERE IRD_TRIP_ID ='0682248010';
SELECT * FROM IOCL_ROUTE_DEVIATIONS WHERE IRD_TRIP_ID ='0682248010';

--- PUT OUTPUT OF FOLLOWING QUEREY IN IOCL_ROUTE_MST

SELECT distinct IAC_IID_ROUTE_ID FROM IOCL_ALLIDLE_CLOSEDTRIPS WHERE IAC_IID_SUPPLY_PLANT_CODE='0682248010';

SELECT * FROM IOCL_ROUTE_MST WHERE IRM_ROUTE_ID IN (104209,598371);


select COUNT(*) from ETRK_IN_MSGS where EIM_VEHICLE_ID = CONVERT(VEH_ID,CHAR) AND EIM_MESSAGE_CREATED_TIME < CHK_TIME AND EIM_MESSAGE_CREATED_TIME <> '0000-00-00 00:000:00' ORDER BY EIM_MESSAGE_CREATED_TIME desc limit 1